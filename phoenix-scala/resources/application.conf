app {
    baseUrl = "http://localhost:9090"
}

db {
  connectionPool = HikariCP
  queueSize = 10000
  driverClassName = "org.postgresql.Driver"
  numThreads=20
  maxConnections=20
  leakDetectionThreshold=60000


  host    = "localhost"
  name    = "phoenix_development"
  name    = ${?PHOENIX_DB_NAME}
  user    = "phoenix"
  baseUrl = "jdbc:postgresql://"${db.host}"/"${db.name}
  url     = ${db.baseUrl}"?user="${db.user}"&prepareThreshold=0"
  driver  = "slick.driver.PostgresDriver"
}

elasticsearch {
  host    = "elasticsearch://localhost:9300"
  cluster = "elasticsearch"
  index   = "admin"
}

# TODO: setup for environments
akka {
  loggers        = ["akka.event.slf4j.Slf4jLogger"]
  loglevel       = "DEBUG"
  logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"
  server {
    remote-address-header = on
  }
}

auth {
  privateKey = ${?PHOENIX_PRIVATE_KEY}
  publicKey = ${?PHOENIX_PUBLIC_KEY}
  method = "basic"
  method = ${?PHOENIX_AUTH_METHOD}

  # TODO: make it shorter (about 5 mins) after refresh-token implementation
  # in minutes, 2 days
  tokenTTL = 2880
  keyAlgorithm = "RS256"

  ## not required, but better to set it.
  cookieDomain = ${?PHOENIX_DOMAIN}

  cookieSecure = on
  cookieSecure = ${?PHOENIX_COOKIE_SECURE}
  # in seconds, 2 days
  cookieTTL = 172800
}

aws {
  accessKey = ${?AWS_ACCESS_KEY}
  secretKey = ${?AWS_SECRET_KEY}
  s3Bucket = ${?S3_BUCKET}
  s3Region = ${?S3_REGION}
}

middlewarehouse {
  url = ${?MIDDLEWAREHOUSE_URL}
}

stripe {
  key = ${?STRIPE_API_KEY}
}

oauth {
  customer {
    google {
      client_id = ${?GOOGLE_OAUTH_CUSTOMER_CLIENT_ID}
      client_secret = ${?GOOGLE_OAUTH_CUSTOMER_CLIENT_SECRET}
      redirect_uri = ${?GOOGLE_OAUTH_CUSTOMER_REDIRECT_URI}
      hosted_domain = ${?GOOGLE_OAUTH_CUSTOMER_HOSTED_DOMAIN}
    }
  }

  admin {
    google {
      client_id = ${?GOOGLE_OAUTH_ADMIN_CLIENT_ID}
      client_secret = ${?GOOGLE_OAUTH_ADMIN_CLIENT_SECRET}
      redirect_uri = ${?GOOGLE_OAUTH_ADMIN_REDIRECT_URI}
      hosted_domain = ${?GOOGLE_OAUTH_ADMIN_HOSTED_DOMAIN}
    }
  }
}

http {
  interface = "0.0.0.0"
  port = 9090
}

app {
  defaultContextId = 1
}

env {
  development {
    akka.loglevel = "DEBUG"
    akka.log-dead-letters-during-shutdown = off
    http.interface = "0.0.0.0"
  }

  staging = ${env.development} {
    http.interface = "0.0.0.0"
  }

  test = ${env.development} {
    db.url    = "jdbc:postgresql://localhost/phoenix_test?user=phoenix&prepareThreshold=0"
    db.name   = "phoenix_test"
    http.interface = "0.0.0.0"

    auth.privateKey = "/auth/private_key.der"
    auth.publicKey = "/auth/public_key.der"
    auth.keyAlgorithm = "RS256"
    auth.keysLocation = "jar"

    tax_rules.region_id = 4129 # California
    tax_rules.rate = 7.5
  }
}

user.customer {
    role = "customer"
    org = "merchant"
    scope_id = 2
}

user.admin {
    role = "admin"
    org = "merchant"
    scope_id = 2
}

tax_rules: {
  region_id: ${?TAX_RULE_REGION},
  rate: ${?TAX_RULE_RATE}
}
