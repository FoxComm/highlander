# storefront as npm package

Что из себя представляет storefront как подключаемый пакет в конечное приложение ?

### Структура

- node.js runtime [отдает статику app.js, app.css; рендерит странички;]
  * Working directory у сервера НЕ меняем, т.е. сервер внутри себя использует только относительные пути и НЕ полагается
    на `process.cwd()`
- browser bundle (app.js) [рантайм для браузера]
- app.css [стили приложения]

### Механизмы переопределения

Требования:

1. Возможность переопределять js компоненты (ui, redux, whatever)
2. Возможность переопределять css, особенно базовые файлы определения стилей как список цветов например

Пути реализации:

Необходим сборщик (который может автоматически запускаться через node.js runtime во время запуска сервера)
который должен уметь:

Как работает сборка сейчас

1. Precompile task преобразует src'es6 в lib'es3
2. browserify task преобразует lib'es3 в app.js

node.js runtime работает с lib'es3
browser runtime работает с app.js

Идеи.

- сборка и node.js runtime знают о том что js-ресурсы могут быть переопределены и сами обрабатывают это
  (в противовес идее, в которой нужно сначала собирать storefront как есть, а потом накатить patch)
- переопределение js-ресурсов через NODE_PATH будет только если эти ресурсы подключается по абсолютному пути.
  Кажется что это может быть достаточным, по крайней мере пока.

To be continued
