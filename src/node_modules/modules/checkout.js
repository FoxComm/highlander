
import {createAction, createReducer} from 'redux-act';
import { assoc } from 'sprout-data';

export const EditStages = {
  shipping: 0,
  delivery: 1,
  billing: 2,
};

export type EditStage = number;

export type ShippingData = {
  city?: string;
}

export type CheckoutState = {
  editStage: EditStage;
  shippingData: ShippingData
};

export const setEditStage = createAction('CHECKOUT_SET_EDIT_STAGE');
export const setShippingData = createAction('CHECKOUT_SET_SHIPPING_DATA', (key, value) => [key, value]);

const initialState: CheckoutState = {
  editStage: EditStages.shipping,
  shippingData: {},
};

const reducer = createReducer({
  [setEditStage]: (state, editStage: EditStage) => {
    return {
      ...state,
      editStage,
    };
  },
  [setShippingData]: (state, [key, value]) => {
    return assoc(state,
      ['shippingData', key], value
    );
  },
}, initialState);

export default reducer;
