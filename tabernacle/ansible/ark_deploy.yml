---

- name: Deploy Ark Apps
  hosts: ark-frontend
  become: true
  vars:
    user: "{{ ansible_user | default(lookup('env', 'USER')) }}"
    api_server: api.foxcommerce.com
    storefront_server_name: api.foxcommerce.com
    db_name: phoenix
    phoenix_db_name: phoenix
    middlewarehouse_db_name: middlewarehouse
    hyperion_db_name: hyperion
    docker_registry: ark.foxcommerce.com
    docker_tags:
        phoenix_seeder: admins
    seeds_cmd: utils.seeds.Seeds seed --seedAdmins
    s3_bucket: foxcomm-production-images
    s3_region: us-west-1
  vars_prompt:
    - name: "phoenix_api_user"
      prompt: "Enter Phoenix API username"
      default: "api@foxcommerce.com"
      private: no
    - name: "phoenix_api_password"
      prompt: "Enter Phoenix API password"
      default: ""
      private: no
  roles:
    - { role: dev/seed_system }
    - { role: dev/marathon }
    - { role: dev/marathon_consumers }
    - { role: dev/ic }
    - { role: dev/balancer }
    - { role: demo/balancer }

  handlers:
    - include: roles/base/consul_agent/handlers/main.yml

