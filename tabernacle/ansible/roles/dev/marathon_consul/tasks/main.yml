---

- name: Override Marathon Consul config
  template: src=config.json dest={{marathon_consul_config_path}}

- name: Wait For Marathon
  wait_for: host={{marathon_host}} port={{marathon_port}}

- name: Subscribe Marathon events to Marathon Consul
  command: curl -X POST 'http://marathon.service.consul:8080/v2/eventSubscriptions?callbackUrl=http://marathon-consul.service.consul:4000/events'

- name: Restart Service
  service: name=marathon-consul state=restarted enabled=true
