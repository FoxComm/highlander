---

- name: Disable Mesos Consul
  systemd: state=stopped enabled=no daemon_reload=yes name=mesos_consul

- name: Remove "marathon" tag in Consul for Marathon
  template: src=marathon.json dest=/etc/consul.d/marathon.json

- name: Remove Mesos Consul service from Consul
  file: path=/etc/consul.d/mesos_consul.json state=absent

- name: Include vars from Mesos Master role
  include_vars: "{{role_path}}/../../base/mesos_master/vars/main.yml"

- name: Add event subscription support for marathon
  template: src="{{role_path}}/../../base/mesos_master/templates/run_marathon.sh" dest=/usr/local/bin mode="u+x,g+x,o+x"

- name: Restart Marathon
  service: name=marathon state=restarted
