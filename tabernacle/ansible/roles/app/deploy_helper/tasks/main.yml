---

- name: Load secrets for Marathon apps
  include_vars: file={{item}}
  with_items:
    - "{{role_path}}/../../base/secret_keys/files/aws/aws.yml"
    - "{{role_path}}/../marathon/vars/main.yml"
    - "{{role_path}}/../marathon/vars/stripe.yml"
    - "{{role_path}}/../marathon/vars/hyperion.yml"
    - "{{role_path}}/../marathon/vars/solomon.yml"

- include: validate.yml

- include: build.yml
  when: branch_name != "master" and auto_build in prompt_yes

- include: deploy.yml

- include: build_after.yml
  when: branch_name != "master" and auto_build in prompt_yes
