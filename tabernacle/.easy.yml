---
shortcuts:

# Ansible shortcuts
- type: snowflake
  process: ansible-playbook -v
  alias: ansible

  flags:
  - name: Inventory Files
    flag: "--inventory-file"
    aliases:
      ark: inventory/static/ark
      dev: inventory/static/dev
      stage_vpn: inventory/static/stage_vpn
      staging: inventory/gce/
      target_dev: inventory/static/target_dev
      topdrawer: inventory/static/topdrawer
      tpg: inventory/static/tpg

  - name: Private Key Files
    flag: "--private-key"
    aliases:
      id_rsa: "~/.ssh/id_rsa"
      gce_rsa: "~/.ssh/gce_rsa"
      tgt.pem: "~/.ssh/tgt.pem"

  - name: SSH Users
    flag: "--user"
    aliases:
      ejik: ejik
      kpashka: kpashka
      pavel: pavel
      ubuntu: ubuntu

  targets:
  # Interactive playbooks
  - name: Setup Annabelle
    alias: annabelle.yml
    target: ansible/ops_annabelle.yml

  - name: Setup Database Backup
    alias: backup_db.yml
    target: ansible/ops_backup_db.yml

  - name: Setup Zookeeper Backup
    alias: backup_zk.yml
    target: ansible/ops_backup_zk.yml

  - name: Setup Consul Alerts
    alias: consul_alerts.yml
    target: ansible/ops_consul_alerts.yml

  - name: Setup Marathon Alerts
    alias: marathon_alerts.yml
    target: ansible/ops_marathon_alerts.yml

  - name: Generate OpenVPN Key
    alias: openvpn_key.yml
    target: ansible/ops_openvpn_key.yml

  - name: Revoke OpenVPN Key
    alias: openvpn_revoke_key.yml
    target: ansible/ops_openvpn_revoke_key.yml

  - name: Setup OpenVPN Server
    alias: openvpn_server.yml
    target: ansible/ops_openvpn_server.yml

  - name: Restore Database
    alias: restore_db.yml
    target: ansible/ops_restore_db.yml

  - name: Setup Sinopia
    alias: sinopia.yml
    target: ansible/ops_sinopia.yml

  - name: Create Store Admin User
    alias: store_admin.yml
    target: ansible/ops_store_admin.yml

  - name: Update UI Testing Software
    alias: selenium.yml
    target: ansible/ops_selenium.yml

  # Goldrush
  - name: Generate Goldrush Configuration
    alias: goldrush_cfg.yml
    target: ansible/goldrush_config_gen.yml

  - name: Debug Goldrush Configuration
    alias: goldrush_debug.yml
    target: ansible/goldrush_debug.yml

  - name: Create Feature Branch Pipeline
    alias: feature_branch.yml
    target: ansible/goldrush_feature_branch.yml

  - name: Update Application Docker Tag
    alias: update_app.yml
    target: ansible/goldrush_update_app.yml

  # Provisioning
  - name: Deploy Storefront
    alias: deploy_storefront.yml
    target: ansible/deploy_storefront.yml

  - name: Provision FoxComm Demo
    alias: demo.yml
    target: ansible/demo.yml

  - name: Provision FoxComm Test
    alias: test_stage.yml
    target: ansible/test_stage.yml

  - name: Provision Appliance
    alias: provision_appliance.yml
    target: ansible/provision_appliance.yml

  # Ark
  - name: Deploy Ark Apps
    alias: ark_deploy.yml
    target: ansible/ark_deploy.yml

  - name: Deploy Ark Keys
    alias: ark_keys.yml
    target: ansible/ark_keys.yml

  # Migrations
  - name: Migrate Phoenix DB
    alias: migrate_phoenix_db.yml
    target: ansible/migrate_phoenix_db.yml

  - name: Migrate MWH DB
    alias: migrate_middlewarehouse_db.yml
    target: ansible/migrate_middlewarehouse_db.yml

  - name: Update Object Schemas
    alias: update_object_schemas.yml
    target: ansible/update_object_schemas.yml

  # Seeders
  - name: Run Phoenix Seeder
    alias: seed_phoenix.yml
    target: ansible/seed_phoenix.yml

  - name: Run Middlewarehouse Seeder
    alias: seed_middlewarehouse.yml
    target: ansible/seed_middlewarehouse.yml

  - name: Run Hyperion Seeder
    alias: seed_hyperion.yml
    target: ansible/seed_hyperion.yml

  - name: Run Data Import Seeder
    alias: seed_data_import.yml
    target: ansible/seed_data_import.yml

# Packer shortcuts
- type: snowflake
  process: packer build
  alias: packer

  flags:
  - name: Build Name Filters
    flag: "-only"
    aliases:
      amazon: amazon
      google: google
  - name: Variable Files
    flag: "-var-file"
    aliases:
      ark: packer/envs/ark/config.json
      target: packer/envs/aws_target/config.json
      staging: packer/envs/staging/config.json
      topdrawer: packer/envs/topdrawer/config.json
      tpg-prod: packer/envs/tpg-prod/config.json

  targets:
  # Base Images
  - name: Base United Image
    alias: base_united.json
    target: packer/base/base_united.json

  - name: Base Appliance Image
    alias: appliance.json
    target: packer/appliance/appliance.json

  - name: Base Buildkite Agent Image
    alias: agent.json
    target: packer/buildkite/agent.json

  # Ark
  - name: Ark Base Image
    alias: ark_base.json
    target: packer/ark/base.json

  - name: Ark Amigo Image
    alias: ark_amigo.json
    target: packer/ark/amigo.json

  - name: Ark Logstash Image
    alias: ark_logstash.json
    target: packer/ark/logstash.json

  - name: Ark Database Image
    alias: ark_database.json
    target: packer/ark/database.json

  - name: Ark Search Image
    alias: ark_search.json
    target: packer/ark/search.json

  - name: Ark Frontend Image
    alias: ark_frontend.json
    target: packer/ark/frontend.json

  # Tinystack
  - name: Tinystack Amigo
    alias: tiny_amigo.json
    target: packer/tinystack/amigo.json

  - name: Tinystack Backend
    alias: tiny_backend.json
    target: packer/tinystack/backend.json

  - name: Tinystack Frontend
    alias: tiny_frontend.json
    target: packer/tinystack/frontend.json

# Terraform shortcuts
- type: monolith
  process: terraform
  alias: terraform
  commands:
  - plan
  - apply

  flags:
  - name: State Files
    flag: "-state"
    aliases:
      ark: terraform/envs/gce_ark/terraform.tfstate
      branches: terraform/envs/gce_branches/terraform.tfstate
      branches2: terraform/envs/gce_branches2/terraform.tfstate
      cloud: terraform/envs/gce_cloud/terraform.tfstate
      dev: terraform/envs/gce_dev/terraform.tfstate
      demo: terraform/envs/gce_demo/terraform.tfstate
      staging: terraform/envs/gce_staging/terraform.tfstate
      target: terraform/envs/aws_target/terraform.tfstate
      topdrawer: terraform/envs/gce_topdrawer/terraform.tfstate
      tpg: terraform/envs/gce_tpg/terraform.tfstate

  - name: Variable Files
    flag: "-var-file"
    aliases:
      ark: terraform/envs/gce_ark/ark.tfvars
      branches: terraform/envs/gce_branches/branches.tfvars
      branches2: terraform/envs/gce_branches2/branches.tfvars
      cloud: terraform/envs/gce_cloud/cloud.tfvars
      dev: terraform/envs/gce_dev/dev.tfvars
      demo: terraform/envs/gce_demo/demo.tfvars
      staging: terraform/envs/gce_staging/staging.tfvars
      target: terraform/envs/aws_target/target.tfvars
      topdrawer: terraform/envs/gce_td/td.tfvars
      tpg: terraform/envs/gce_tpg/tpg.tfvars

  targets:
  - name: Ark Production
    alias: ark
    target: terraform/base/gce_ark

  - name: FoxCommerce Cloud
    alias: cloud
    target: terraform/base/gce_cloud

  - name: Feature Branch Instances
    alias: branches
    target: terraform/base/gce_branches

  - name: Feature Branch Instances 2
    alias: branches2
    target: terraform/base/gce_branches2

  - name: FoxCommerce Core
    alias: dev
    target: terraform/base/gce_dev

  - name: FoxCommerce Test
    alias: staging
    target: terraform/base/gce_staging

  - name: Target AWS Networking
    alias: target
    target: terraform/base/aws_target

  - name: TopDrawer Production
    alias: topdrawer
    target: terraform/base/gce_td

  - name: TPG Production
    alias: tpg
    target: terraform/base/gce_tpg
