---

- name: Install Pre-requisites
  apt: name={{item}} state=latest force=yes
  sudo: true
  with_items:
    - git
    - devscripts
    - debhelper
    - build-essential
    - dh-make

- name: Get Docker GC
  git: repo={{docker_gc_repo}} dest={{docker_gc_dir}}
  sudo: true

- name: Build Debian Package
  command: debuild -us -uc -b
  args:
    chdir: "{{docker_gc_dir}}"
  sudo: true

- name: Install Debian Package
  command: dpkg -i {{home}}/{{docker_gc_deb}}
  sudo: true

- name: Copy To Daily Cron Tasks
  template: src=docker-gc.sh dest=/etc/cron.daily/docker-gc.sh
  sudo: true

- name: Make It Executable
  command: chmod +x /etc/cron.daily/docker-gc.sh
  sudo: true
