---
# Deploy available checks/plugins/handlers/filters/mutators

  - name: Install remote plugins
    shell: sensu-install -p {{ item }}
    with_items: "{{ sensu_remote_plugins }}"
    changed_when: false
    when: sensu_remote_plugins > 0

  - name: Deploy definitions to the master
    template: src="{{ item }}" dest="{{ sensu_config_path }}/conf.d/{{ item | basename }}"
    when: sensu_master
    with_fileglob:
      - "{{ sensu_definitions_store }}/*"
    notify:
      - restart sensu-server service
      - restart sensu-api service
