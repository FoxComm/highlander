upstream storefront {
  {{ '{{' }} range service "storefront" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{storefront_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream search {
  {{ '{{' }} range service "elasticsearch" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{search_server_http}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream phoenix {
  {{ '{{' }} range service "phoenix" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{phoenix_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream isaac {
  {{ '{{' }} range service "isaac" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{isaac_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream middlewarehouse {
  {{ '{{' }} range service "middlewarehouse" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{middlewarehouse_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream sol {
  {{ '{{' }} range service "solomon" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{solomon_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream ashes {
  {{ '{{' }} range service "ashes" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{ashes_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}

upstream marathon {
  {{ '{{' }} range service "marathon" {{ '}}'}} server {{ '{{'}} .Address {{ '}}' }}:{{ '{{' }} .Port {{ '}}' }} max_fails=10 fail_timeout=30s weight=1;
  {{ '{{' }} else {{ '}}' }} server {{marathon_server}} fail_timeout=30s max_fails=10; {{ '{{' }} end {{ '}}' }}
}
