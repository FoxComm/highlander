---
- name: Kill Kafka if it is Running
  shell: systemctl stop kafka || true
  become: true

- name: Purge Kafka Queue
  file: path=/var/lib/kafka state=absent
  become: true

- name: Create Kafka dir
  file: path=/var/lib/kafka state=directory
  become: true

- name: Override Kafka config
  template: src=server.properties dest="/etc/kafka/server.properties"
  become: true

- name: Restart Kafka
  service: name=kafka state=started enabled=yes
  become: true

- name: Sleep
  shell: sleep 5

- name: Restart Schema Registry
  service: name=schema-registry state=started enabled=yes
  become: true
