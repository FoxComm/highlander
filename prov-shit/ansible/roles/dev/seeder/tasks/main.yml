---

- name: Seed Phoenix Database
  shell: java -Dphoenix.env={{phoenix_env}} -Ddb.host={{db_host}} -Ddb.url="jdbc:postgresql://{{db_host}}/{{db_name}}?user={{db_user}}" -Ddb.name={{db_name}} -cp {{phoenix_jar}} {{seeds_cmd}}
  sudo: true
  args:
    chdir: "{{phoenix_dir}}"
    
- name: Gatling Seed Db
  shell: java -Dphoenix.env={{phoenix_env}} -Ddb.host={{db_host}} -Ddb.url="jdbc:postgresql://{{db_host}}/{{db_name}}?user={{db_user}}" -Ddb.name={{db_name}} -cp {{phoenix_jar}} {{gatling_oneshot_seeds_cmd}}
  sudo: true
  args:
    chdir: "{{phoenix_dir}}"

- name: Copy Service
  template: src=seeder.service dest="{{dest_services}}/seeder.service"
  sudo: true

- name: Reload Systemd for Seeder
  sudo: yes
  command: systemctl daemon-reload

- name: Restart Seeder
  service: name=seeder state=restarted enabled=yes
  sudo: true
