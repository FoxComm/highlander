---

- name: Create Docker Registry config folder
  file: path={{docker_registry_config_dir}} state=directory

- name: Copy Docker Compose config
  template: src=docker-compose.yml dest={{docker_registry_config_dir}}/

- name: Copy Service
  template: src=docker_registry.service dest={{dest_services}}/

- name: Create Certs directory
  file: path=/certs state=directory mode=600

- name: Copy Cert
  copyv: src={{playbook_dir}}/roles/base/secret_keys/files/certs/{{datacenter}}/docker/domain.crt dest=/certs/domain.crt

- name: Copy Key
  copyv: src={{playbook_dir}}/roles/base/secret_keys/files/certs/{{datacenter}}/docker/domain.key dest=/certs/domain.key

- name: Reload Systemd for Docker Registry
  command: systemctl daemon-reload
