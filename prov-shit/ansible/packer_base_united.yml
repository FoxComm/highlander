---

- name: Packing Base Image
  hosts: all
  become: true
  tags:
    - packer
  vars:
    user: ubuntu
    packing: true
  gather_facts: no
  pre_tasks:
    - name: Update Apt Cache
      raw: sudo apt-get update
    - name: Install Python 2 and Boto
      raw: sudo apt-get -y install python2.7 python-boto
    - name: Gather Facts
      setup:
  post_tasks:
    - name: Take a nap for a while
      pause: seconds=5

  roles:
    - { role: base/common }
    - { role: base/secret_keys, install_public_keys: true, install_private_keys: true }
    - { role: base/consul }
    - { role: base/docker }
    - { role: base/mesos }
    - { role: base/consul_agent }
