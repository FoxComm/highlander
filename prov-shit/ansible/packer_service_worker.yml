---

- name: Provision Packer Vanilla Kafka
  hosts: all
  tags:
      - packer-vanilla-phoenix
  vars:
    user: ubuntu
    packing: true
    phoenix_env: staging
    db_host: db.service.consul
    db_user: phoenix
    db_name: phoenix_development
    phoenix_db_name: phoenix_development
    phoenix_tracing: "true"
    zipkin_collector: zipkin.service.consul
    log_host: es-log.service.consul
    phoenix_service_requires: ""
    phoenix_service_after: ""
    middlewarehouse_service_requires: ""
    middlewarehouse_service_after: ""
    mesos_master: mesos_master.service.consul
  post_tasks:
    - name: Sweet Dreams
      pause: seconds=5

  roles:
    - { role: base/ssh_keys }
    - { role: base/rsyslog, sudo: yes }
    - { role: base/consul_agent }
    - { role: base/mesos_worker }
