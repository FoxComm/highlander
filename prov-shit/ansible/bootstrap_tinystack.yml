---

- name: Bootstrap Amigo
  hosts: '{{hostname}}'
  tags:
    - amigo
  vars:
    user: "{{ ansible_user | default(lookup('env', 'USER')) }}"
  vars_prompt:
    - name: "hostname"
      prompt: "Enter a hostname with a backend to provision"
      default: "vanilla-amigo"
      private: no

  roles:
    - { role: dev/kibana, become: true }

- name: Bootstrap Backend
  hosts: '{{hostname}}'
  vars:
    user: "{{ ansible_user | default(lookup('env', 'USER')) }}"
    upload_phoenix_jar: true
  vars_prompt:
    - name: "hostname"
      prompt: "Enter a backend hostname"
      default: "foxcomm-tony-backend"
      private: no

  roles:
      - { role: dev/kafka }
      - { role: dev/elasticsearch }
      - { role: dev/db, become: true }

- name: Bootstrap Frontend
  hosts: '{{hostname}}'
  vars:
    user: "{{ ansible_user | default(lookup('env', 'USER')) }}"
    upload_phoenix_jar: true
    first_run: true
  vars_prompt:
    - name: "hostname"
      prompt: "Enter a frontend hostname"
      default: "foxcomm-tony-frontend"
      private: no

  roles:
      - { role: dev/phoenix }
      - { role: dev/greenriver }
      - { role: dev/seeder }
