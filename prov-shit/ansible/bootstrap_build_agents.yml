---

- name: Provision Buildkite Agent Machines
  hosts:
    - buildkite-agent-0
    - buildkite-agent-1
    - buildkite-agent-2
    - buildkite-agent-3
    - buildkite-agent-4
    - buildkite-agent-5
    - buildkite-agent-6
    - buildkite-agent-7
  tags:
    - buildkite-agent
  vars:
    user: '{{ansible_ssh_user}}'

  roles:
    - { role: base/common }
    - { role: base/ssh_keys }
    - { role: base/scala }
    - { role: base/node }
    - { role: base/builder }
    - { role: test/db }
    - { role: test/selenium }
    - { role: dev/ssh_gce }

  tasks:
    - include: tasks/restart_buildkite_agent.yml
