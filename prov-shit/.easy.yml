---
shortcuts:

# Ansible shortcuts
- type: snowflake
  process: ansible-playbook -vvvv
  alias: ansible

  flags:
  - name: Inventory Files
    flag: "--inventory-file"
    aliases:
      api_docs: bin/envs/api_docs
      stage_vpn: bin/envs/stage_vpn
      staging: bin/envs/staging
      target_aws: bin/envs/target_aws
      topdrawer: bin/envs/topdrawer
      topdrawer_vpn: bin/envs/topdrawer_vpn
      tpg: bin/envs/tpg
      tpg_vpn: bin/envs/tpg_vpn
  - name: Private Key Files
    flag: "--private-key"
    aliases:
      id_rsa: "~/.ssh/id_rsa"
      gce_rsa: "~/.ssh/gce_rsa"
      tgt.pem: "~/.ssh/tgt.pem"
  - name: SSH Users
    flag: "--user"
    aliases:
      ejik: ejik
      pavel: pavel
      ubuntu: ubuntu

  targets:
  # Bootstrappers
  - name: Bootstrap Annabelle
    alias: annabelle.yml
    target: ansible/bootstrap_annabelle.yml
  - name: Bootstrap Backend
    alias: backend.yml
    target: ansible/bootstrap_backend.yml
  - name: Bootstrap Build Agents Keys
    alias: build_agent_keys.yml
    target: ansible/bootstrap_build_agent_keys.yml
  - name: Bootstrap Consul Alerts
    alias: consul_alerts.yml
    target: ansible/bootstrap_consul_alerts.yml
  - name: Bootstrap Database Backup
    alias: db_backup.yml
    target: ansible/bootstrap_db_backup.yml
  - name: Bootstrap Messaging Plugin
    alias: messaging_plugin.yml
    target: ansible/bootstrap_messaging_plugin.yml
  - name: Bootstrap OpenVPN Key
    alias: openvpn_key.yml
    target: ansible/bootstrap_openvpn_key.yml
  - name: Bootstrap Phoenix DB
    alias: db_phoenix.yml
    target: ansible/bootstrap_db_phoenix.yml
  - name: Bootstrap Tinystack
    alias: tinystack.yml
    target: ansible/bootstrap_tinystack.yml
  - name: Bootstrap Vanilla
    alias: vanilla.yml
    target: ansible/bootstrap_vanilla.yml
  - name: Bootstrap Vanilla DB
    alias: vanilla_db.yml
    target: ansible/bootstrap_vanilla_db.yml
  - name: Bootstrap Vanilla Seeder
    alias: vanilla_seed.yml
    target: ansible/bootstrap_vanilla_seed.yml
  - name: Bootstrap Vanilla VPN
    alias: vanilla_vpn.yml
    target: ansible/bootstrap_vanilla_vpn.yml

  # New goodies
  - name: Provision TPG Staging
    alias: tpg_staging.yml
    target: ansible/tpg_staging.yml
  - name: Deploy Mesos Consul
    alias: mesos_consul.yml
    target: ansible/hotfix_mesos_consul.yml
  - name: Deploy Secret Keys
    alias: secret_keys.yml
    target: ansible/hotfix_secret_keys.yml

# Packer shortcuts
- type: snowflake
  process: packer build
  alias: packer

  flags:
  - name: Build Name Filters
    flag: "-only"
    aliases:
      amazon: amazon
      google: google
  - name: Variable Files
    flag: "-var-file"
    aliases:
      target: packer/envs/aws_target/config.json
      staging: packer/envs/staging/config.json
      topdrawer: packer/envs/topdrawer/config.json
      tpg: packer/envs/tpg/config.json

  targets:
  # Base Images
  - name: Base Image
    alias: base.json
    target: packer/base/base.json

  # Tinystack
  - name: Tinystack Amigo
    alias: tiny_amigo.json
    target: packer/base/tinystack_amigo.json
  - name: Tinystack Backend
    alias: tiny_backend.json
    target: packer/base/tinystack_backend.json
  - name: Tinystack Frontend
    alias: tiny_frontend.json
    target: packer/base/tinystack_frontend.json

# Terraform shortcuts
- type: monolith
  process: terraform
  alias: terraform
  commands:
  - plan
  - apply

  flags:
  - name: State Files
    flag: "-state"
    aliases:
      dev: terraform/envs/gce_dev/terraform.tfstate
      staging: terraform/envs/gce_staging/terraform.tfstate
      gatling: terraform/envs/gce_gatling/terraform.tfstate
      target: terraform/envs/aws_target/terraform.tfstate
      target-dev: terraform/envs/aws_target_dev/terraform.tfstate
      topdrawer: terraform/envs/gce_topdrawer/terraform.tfstate
      tpg: terraform/envs/gce_tpg/terraform.tfstate
  - name: Variable Files
    flag: "-var-file"
    aliases:
      dev: terraform/envs/gce_dev/dev.tfvars
      staging: terraform/envs/gce_staging/staging.tfvars
      gatling: terraform/envs/gce_gatling/gatling.tfvars
      target: terraform/envs/aws_target/target.tfvars
      target-dev: terraform/envs/aws_target_dev/target.tfvars
      topdrawer: terraform/envs/gce_topdrawer/topdrawer.tfvars
      tpg: terraform/envs/gce_tpg/tpg.tfvars

  targets:
  - name: Staging Legacy
    alias: dev
    target: terraform/base/gce_dev
  - name: Staging Highlander
    alias: staging
    target: terraform/base/gce_staging
  - name: Staging Gatling
    alias: gatling
    target: terraform/base/gce_gatling
  - name: Target AWS Networking
    alias: target
    target: terraform/base/aws_target
  - name: Target AWS Cluster
    alias: target-dev
    target: terraform/base/aws_target_dev
  - name: TopDrawer
    alias: topdrawer
    target: terraform/base/gce_topdrawer
  - name: The Perfect Gourmet
    alias: tpg
    target: terraform/base/gce_tpg
