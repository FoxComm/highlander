---

- name: Remove Firebird Dir
  file: path={{firebird_install_dir}} state=absent

- name: Add Firebird Dir
  file: path={{firebird_install_dir}} state=directory

- name: Sleep
  shell: sleep 1

- name: Untar Firebird code
  unarchive:
    src: '{{firebird_source_package}}'
    dest: '{{firebird_install_dir}}'

- name: Build Firebird
  shell: NODE_ENV={{firebird_env}} DEMO_USER={{demo_user}} DEMO_PASS={{demo_pass}} FIREBIRD_LANGUAGE={{firebird_default_language}} gulp build
  args:
    chdir: "{{firebird_install_dir}}"
  when: demo_user != ""

- name: Install firebird run script
  sudo: true
  template: src=../../base/firebird/run_firebird.sh.j2 dest="{{ firebird_install_dir }}/run_firebird.sh" mode="u=rwx,g=rwx,o=r"

- name: Restart Firebird
  service: name=firebird state=restarted
  sudo: true
