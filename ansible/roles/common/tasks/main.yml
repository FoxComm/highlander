---
- name: Add Oracle Java Repository
  apt_repository: repo='ppa:webupd8team/java' update_cache=yes
  sudo: true

- name: Automatically select the Oracle License
  sudo: true
  shell: echo "oracle-java8-installer shared/accepted-oracle-license-v1-1 select true" | sudo debconf-set-selections

- name: Install Packages
  apt: name={{ item }} state=latest force=yes
  sudo: true
  with_items:
    - curl
    - debconf-utils
    - jq
    - make
    - python-httplib2
    - python-software-properties
    - software-properties-common
    - tmux
    - htop
    - unzip

- name: Install Java Packages
  apt: name={{ item }} state=latest force=yes
  sudo: true
  with_items:
    - oracle-java8-installer
    - oracle-java8-set-default
    - ca-certificates-java

- name: Setup Unprivileged
  command: /usr/sbin/usermod -a -G systemd-journal {{ user }}
  sudo: true

- name: Create Swap File
  shell: "dd if=/dev/zero of={{ swap_file }} bs=1048576 count={{ swap_size_mb }}"
  sudo: true
  args:
      creates: "{{ swap_file }}"

- name: Change swap file permissions
  file: path="{{ swap_file}}" owner=root group=root mode=0600
  sudo: true

- name: Make Swap File
  shell: "sudo mkswap {{ swap_file }} || true"
  sudo: true

- name: Mount Swap
  shell: "swapon {{ swap_file }} || true"
  sudo: true
