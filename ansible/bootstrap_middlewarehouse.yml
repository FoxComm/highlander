---

- name: Provision Middlewarehouse
  hosts: '{{hostname}}'
  vars:
    updating_mwh: true
    user: '{{ansible_ssh_user}}'
    flyway_vers: 3.2.1
    flyway_dir: "/usr/local/share/flyway-{{flyway_vers}}"
    flyway: "{{flyway_dir}}/flyway -locations=filesystem:sql/ -configFile=sql/flyway.conf"
  vars_prompt:
    - name: "hostname"
      prompt: "Enter a hostname with a middlewarehouse to provision"
      default: "stage-backend"
      private: no
    - name: "middlewarehouse_src"
      prompt: "Enter a local path to middlewarehouse source directory"
      default: "~/golang/src/github.com/FoxComm/middlewarehouse"
      private: no
    - name: "middlewarehouse_bin_src"
      prompt: "Enter a local path to middlewarehouse binary"
      default: "~/golang/src/github.com/FoxComm/middlewarehouse/middlewarehouse"
      private: no
    - name: "stock_items_consumer_bin_src"
      prompt: "Enter a local path to middlewarehouse stock-items-consumer binary"
      default: "~/golang/src/github.com/FoxComm/middlewarehouse/consumers/stock-items/stock-items-consumer"
      private: no

  roles:
    - { role: dev/middlewarehouse }
